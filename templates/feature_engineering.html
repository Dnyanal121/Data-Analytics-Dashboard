<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Feature Engineering Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-light bg-white shadow-sm mb-4">
    <div class="container">
      <a class="navbar-brand fw-bold text-primary" href="{{ url_for('operation') }}">‚öôÔ∏è Feature Engineering</a>
      <div>
        <a class="btn btn-outline-secondary btn-sm" href="{{ url_for('operation') }}">Back</a>
      </div>
    </div>
  </nav>

  <main class="container mb-5">
    <h4 class="mb-4">üß† Feature Engineering Tools</h4>

    <!-- Feature Engineering Form -->
    <form method="post" action="{{ url_for('feature_engineering_page') }}">
      <div class="card shadow-sm mb-4">
        <div class="card-body">
          <p class="mb-3"><strong>Select an Action:</strong></p>

          <!-- Radio Buttons for Actions -->
          <div class="row row-cols-1 row-cols-md-2 g-2">
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Missing Value Imputation" id="impute" required><label for="impute">Missing Value Imputation</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Drop Column" id="drop"><label for="drop">Drop Column</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Label Encoding" id="label"><label for="label">Label Encoding</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="One-Hot Encoding" id="onehot"><label for="onehot">One-Hot Encoding</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Feature Scaling" id="scale"><label for="scale">Feature Scaling (StandardScaler)</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Outlier Removal" id="outlier"><label for="outlier">Outlier Removal (IQR Method)</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Log Transformation" id="log"><label for="log">Log Transformation</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Create New Feature" id="newfeat"><label for="newfeat">Create New Feature</label></div>
            <div class="col"><input class="form-check-input me-2" type="radio" name="action" value="Correlation Filtering" id="corr"><label for="corr">Correlation Filtering</label></div>
          </div>

          <!-- Optional Column Selection -->
          <div class="mt-4">
            <label class="form-label">Optional: Column (if applicable)</label>
            <select name="column" class="form-select">
              <option value="">-- Select column (optional) --</option>
              {% if cols %}
                {% for c in cols %}
                  <option value="{{ c }}">{{ c }}</option>
                {% endfor %}
              {% endif %}
            </select>
          </div>

          <!-- Extra Expression Input (for new feature creation) -->
          <div class="mt-3">
            <label class="form-label">Extra Input (for 'Create New Feature', e.g. <code>new_col = col1 * col2</code>)</label>
            <input type="text" class="form-control" name="extra" placeholder="e.g. profit_margin = revenue / cost">
          </div>

          <!-- Submit Button -->
          <div class="mt-4">
            <button type="submit" class="btn btn-primary w-100">Run Feature Engineering</button>
          </div>
        </div>
      </div>
    </form>

    <!-- Result Display -->
    {% if result %}
    <div class="card shadow-sm mb-4">
      <div class="card-body">
        <h5 class="text-success">‚úÖ Result Summary</h5>
        <p><strong>Message:</strong> {{ result['message'] }}</p>
        <p><strong>Shape Change:</strong> {{ result['shape_change'] }}</p>
      </div>
    </div>

    <div class="card shadow-sm">
      <div class="card-body">
        <h6>üìä Sample of Processed Data</h6>
        <div class="table-responsive">
          {{ result['sample_head'] | safe }}
        </div>
      </div>
    </div>
    {% endif %}

    <div class="mt-4 text-center">
      <a href="{{ url_for('operation') }}" class="btn btn-outline-secondary">‚¨ÖÔ∏è Back to Main Menu</a>
    </div>
  </main>
</body>
</html>
